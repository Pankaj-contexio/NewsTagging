<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Chatbot</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js" integrity="sha384-wfVd4G7yzTf/3GQ8LNk31DJ7tY79DbDeihdj5Z8SGvtQvECOH14R/2uOeGjn5ERa" crossorigin="anonymous"></script>
</head>
<body>
<h2>Support Chat</h2>
<div id="messages" style="border:1px solid #ccc;height:300px;overflow-y:scroll;padding:5px;margin-bottom:10px;"></div>
<input type="text" id="message" placeholder="Type your question" style="width:80%;"/>
<button id="send">Send</button>

<script>
const socket = io();
const msgs = $('#messages');

function appendMessage(m){
    msgs.append('<div><strong>'+m.sender+':</strong> '+m.text+'</div>');
    msgs.scrollTop(msgs[0].scrollHeight);
}

socket.on('init_messages', function(data){
    msgs.empty();
    data.forEach(appendMessage);
});

socket.on('new_message', function(m){
    appendMessage(m);
});

$('#send').on('click', function(){
    var text = $('#message').val();
    socket.emit('send_message', {text:text});
    $('#message').val('');
});
</script>
</body>
</html>
